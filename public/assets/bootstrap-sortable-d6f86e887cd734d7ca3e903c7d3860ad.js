!function(t,e){"use strict";function a(){return e}"function"==typeof define&&define.amd?define("tinysort",a):t.tinysort=e}(this,function(){"use strict";function t(t,s){function d(){0===arguments.length?b({}):r(arguments,function(t){b(a(t)?{selector:t}:t)}),m=z.length}function b(t){var e=!!t.selector,a=e&&":"===t.selector[0],r=o(t||{},g);z.push(o({hasSelector:e,hasAttr:!(r.attr===i||""===r.attr),hasData:r.data!==i,hasFilter:a,sortReturnNumber:"asc"===r.order?1:-1},r))}function y(){r(t,function(t,e){x?x!==t.parentNode&&(q=!1):x=t.parentNode;var a=z[0],r=a.hasFilter,o=a.selector,s=!o||r&&t.matchesSelector(o)||o&&t.querySelector(o),n=s?A:k,l={elm:t,pos:e,posn:n.length};N.push(l),n.push(l)}),F=A.slice(0)}function S(){A.sort(w)}function w(t,o){var s=0;for(0!==v&&(v=0);0===s&&m>v;){var i=z[v],d=i.ignoreDashes?h:f;if(r(p,function(t){var e=t.prepare;e&&e(i)}),i.sortFunction)s=i.sortFunction(t,o);else if("rand"==i.order)s=Math.random()<.5?1:-1;else{var c=l,g=e(t,i),b=e(o,i),y=""===g||g===n,S=""===b||b===n;if(g===b)s=0;else if(i.emptyEnd&&(y||S))s=y&&S?0:y?1:-1;else{if(!i.forceStrings){var w=a(g)?g&&g.match(d):l,C=a(b)?b&&b.match(d):l;if(w&&C){var F=g.substr(0,g.length-w[0].length),x=b.substr(0,b.length-C[0].length);F==x&&(c=!l,g=u(w[0]),b=u(C[0]))}}s=g===n||b===n?0:b>g?-1:g>b?1:0}}r(p,function(t){var e=t.sort;e&&(s=e(i,c,g,b,s))}),s*=i.sortReturnNumber,0===s&&v++}return 0===s&&(s=t.pos>o.pos?1:-1),s}function C(){var t=A.length===N.length;q&&t?D?A.forEach(function(t,e){t.elm.style.order=e}):(A.forEach(function(t){E.appendChild(t.elm)}),x.appendChild(E)):(A.forEach(function(t){var e=t.elm,a=c.createElement("div");t.ghost=a,e.parentNode.insertBefore(a,e)}),A.forEach(function(t,e){var a=F[e].ghost;a.parentNode.insertBefore(t.elm,a),a.parentNode.removeChild(a)}))}a(t)&&(t=c.querySelectorAll(t)),0===t.length&&console.warn("No elements to sort");var F,x,E=c.createDocumentFragment(),N=[],A=[],k=[],z=[],q=!0,D=t.length&&(s===n||s.useFlex!==!1)&&-1!==getComputedStyle(t[0].parentNode,null).display.indexOf("flex");return d.apply(i,Array.prototype.slice.call(arguments,1)),y(),S(),C(),A.map(function(t){return t.elm})}function e(t,e){var r,o=t.elm;return e.selector&&(e.hasFilter?o.matchesSelector(e.selector)||(o=i):o=o.querySelector(e.selector)),e.hasAttr?r=o.getAttribute(e.attr):e.useVal?r=o.value||o.getAttribute("value"):e.hasData?r=o.getAttribute("data-"+e.data):o&&(r=o.textContent),a(r)&&(e.cases||(r=r.toLowerCase()),r=r.replace(/\s+/g," ")),r}function a(t){return"string"==typeof t}function r(t,e){for(var a,r=t.length,o=r;o--;)a=r-o-1,e(t[a],a)}function o(t,e,a){for(var r in e)(a||t[r]===n)&&(t[r]=e[r]);return t}function s(t,e,a){p.push({prepare:t,sort:e,sortBy:a})}var n,l=!1,i=null,d=window,c=d.document,u=parseFloat,f=/(-?\d+\.?\d*)\s*$/g,h=/(\d+\.?\d*)\s*$/g,p=[],m=0,v=0,g={selector:i,order:"asc",attr:i,data:i,useVal:l,place:"start",returns:l,cases:l,forceStrings:l,ignoreDashes:l,sortFunction:i,useFlex:l,emptyEnd:l};return d.Element&&function(t){t.matchesSelector=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector||function(t){for(var e=this,a=(e.parentNode||e.document).querySelectorAll(t),r=-1;a[++r]&&a[r]!=e;);return!!a[r]}}(Element.prototype),o(s,{loop:r}),o(t,{plugin:s,defaults:g})}()),function(t){function e(e){var a=e.data("bootstrap-sortable-context");return void 0===a&&(a={bsSort:[],lastSort:void 0},e.find('thead th[data-defaultsort!="disabled"]').each(function(){var e=t(this),r=e.attr("data-sortkey");a.bsSort[r]=e.attr("data-defaultsort"),void 0!==a.bsSort[r]&&(a.lastSort=r)}),e.data("bootstrap-sortable-context",a)),a}function a(t,e){tinysort(t,e)}function r(a,n){var l=parseFloat(a.attr("data-sortcolumn")),i=e(n),d=i.bsSort,c=a.attr("colspan");if(c){var u=parseFloat(a.data("mainsort"))||0,f=parseFloat(a.data("sortkey").split("-").pop());if(n.find("thead tr").length-1>f)return void r(n.find('[data-sortkey="'+(l+u)+"-"+(f+1)+'"]'),n);l+=u}var h=a.attr("data-defaultsign")||o;if(n.find("th").each(function(){t(this).removeClass("up").removeClass("down").addClass("nosort")}),t.browser.mozilla){var p=n.find("div.mozilla");void 0!==p&&(p.find(".sign").remove(),p.parent().html(p.html())),a.wrapInner('<div class="mozilla"></div>'),a.children().eq(0).append('<span class="sign '+h+'"></span>')}else n.find("span.sign").remove(),a.append('<span class="sign '+h+'"></span>');var m=a.attr("data-sortkey"),v="desc"!==a.attr("data-firstsort")?"desc":"asc";i.lastSort=m,d[m]="asc"===(d[m]||v)?"desc":"asc","desc"===d[m]?(a.find("span.sign").addClass("up"),a.addClass("up").removeClass("down nosort")):a.addClass("down").removeClass("up nosort");var g=n.children("tbody").children("tr");s(g,{selector:"td:nth-child("+(l+1)+")",order:d[m],data:"value"}),n.find("td.sorted, th.sorted").removeClass("sorted"),g.find("td:eq("+l+")").addClass("sorted"),a.addClass("sorted")}var o,s,n=t(document);if(t.bootstrapSortable=function(n,l,i){var d="undefined"!=typeof moment;o=l?l:"arrow","default"==i&&(i=a),s=i||s||a,t("table.sortable").each(function(){var a=t(this);n=n===!0,a.find("span.sign").remove(),a.find("thead [colspan]").each(function(){for(var e=parseFloat(t(this).attr("colspan")),a=1;e>a;a++)t(this).after('<th class="colspan-compensate">')}),a.find("thead [rowspan]").each(function(){for(var e=t(this),a=parseFloat(e.attr("rowspan")),r=1;a>r;r++){var o=e.parent("tr"),s=o.next("tr"),n=o.children().index(e);s.children().eq(n).before('<th class="rowspan-compensate">')}}),a.find("thead tr").each(function(e){t(this).find("th").each(function(a){var r=t(this);r.addClass("nosort").removeClass("up down"),r.attr("data-sortcolumn",a),r.attr("data-sortkey",a+"-"+e)})}),a.find("thead .rowspan-compensate, .colspan-compensate").remove(),a.find("td").each(function(){var e=t(this);void 0!==e.attr("data-dateformat")&&d?e.attr("data-value",moment(e.text(),e.attr("data-dateformat")).format("YYYY/MM/DD/HH/mm/ss")):void 0===e.attr("data-value")&&e.attr("data-value",e.text())});var o=e(a),s=o.bsSort;a.find('thead th[data-defaultsort!="disabled"]').each(function(){var e=t(this),a=e.closest("table.sortable");e.data("sortTable",a);var l=e.attr("data-sortkey"),i=n?o.lastSort:-1;s[l]=n?s[l]:e.attr("data-defaultsort"),void 0!==s[l]&&n===(l===i)&&(s[l]="asc"===s[l]?"desc":"asc",r(e,a))}),a.trigger("sorted")})},n.on("click",'table.sortable thead th[data-defaultsort!="disabled"]',function(){var e=t(this),a=e.data("sortTable")||e.closest("table.sortable");a.trigger("before-sort"),r(e,a),a.trigger("sorted")}),!t.browser){t.browser={chrome:!1,mozilla:!1,opera:!1,msie:!1,safari:!1};var l=navigator.userAgent;t.each(t.browser,function(e){t.browser[e]=new RegExp(e,"i").test(l)?!0:!1,t.browser.mozilla&&"mozilla"===e&&(t.browser.mozilla=new RegExp("firefox","i").test(l)?!0:!1),t.browser.chrome&&"safari"===e&&(t.browser.safari=!1)})}t(t.bootstrapSortable)}(jQuery);